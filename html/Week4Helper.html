<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Week 4 Pre-Reading: Preprocessing Your Data | CMM548</title>
<link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;600;700&family=Source+Code+Pro:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --purple: #682773;
    --purple-light: #F7ECF8;
    --purple-mid: #9B59B6;
    --purple-dark: #4A1A52;
    --orange: #E67E22;
    --orange-light: #FEF5EC;
    --blue: #2980B9;
    --blue-light: #EBF5FB;
    --green: #27AE60;
    --green-light: #EAFAF1;
    --red: #E74C3C;
    --red-light: #FDEDEC;
    --text: #2C3E50;
    --text-light: #5D6D7E;
    --bg: #FAFBFC;
    --card-bg: #FFFFFF;
    --border: #E8E8E8;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Source Sans 3', -apple-system, sans-serif;
    color: var(--text);
    background: var(--bg);
    line-height: 1.7;
    font-size: 17px;
  }

  header {
    background: linear-gradient(135deg, var(--purple-dark), var(--purple));
    color: white;
    padding: 3rem 2rem 2.5rem;
    text-align: center;
  }
  header .tag {
    display: inline-block;
    background: rgba(255,255,255,0.18);
    color: #f0e0f4;
    font-size: 0.82rem;
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    padding: 0.3em 1em;
    border-radius: 20px;
    margin-bottom: 1rem;
  }
  header h1 {
    font-size: 2.2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    line-height: 1.2;
  }
  header p {
    font-size: 1.05rem;
    opacity: 0.88;
    max-width: 640px;
    margin: 0 auto;
    font-weight: 300;
  }

  .container {
    max-width: 860px;
    margin: 0 auto;
    padding: 2rem 1.5rem 3rem;
  }

  .intro-box {
    background: var(--purple-light);
    border-left: 4px solid var(--purple);
    border-radius: 0 8px 8px 0;
    padding: 1.3rem 1.5rem;
    margin-bottom: 2.5rem;
    font-size: 0.97rem;
  }
  .intro-box strong { color: var(--purple); }

  .toc {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 1.3rem 1.5rem;
    margin-bottom: 2.5rem;
  }
  .toc h3 {
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 0.6rem;
    color: var(--purple);
  }
  .toc-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.3rem 1.5rem;
  }
  .toc a {
    color: var(--purple);
    text-decoration: none;
    font-size: 0.92rem;
    display: flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.2rem 0;
  }
  .toc a:hover { text-decoration: underline; }
  .toc a .num {
    background: var(--purple-light);
    color: var(--purple);
    width: 22px; height: 22px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: 700;
    flex-shrink: 0;
  }

  .concept {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 12px;
    margin-bottom: 2rem;
    overflow: hidden;
    box-shadow: 0 1px 4px rgba(0,0,0,0.04);
  }
  .concept-header {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    padding: 1.2rem 1.5rem;
    background: var(--purple-light);
    border-bottom: 1px solid #EDE0F0;
  }
  .concept-num {
    width: 36px; height: 36px;
    background: var(--purple);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1rem;
    flex-shrink: 0;
  }
  .concept-header h2 {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--purple-dark);
  }
  .concept-body {
    padding: 1.5rem;
  }
  .concept-body p { margin-bottom: 1rem; }

  .key-term {
    background: var(--purple-light);
    color: var(--purple-dark);
    padding: 0.1em 0.45em;
    border-radius: 4px;
    font-weight: 600;
  }

  code {
    font-family: 'Source Code Pro', monospace;
    background: #F0EDF2;
    padding: 0.15em 0.4em;
    border-radius: 3px;
    font-size: 0.88em;
    color: var(--purple-dark);
  }

  .visual-panel {
    background: #FAFBFC;
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 1.2rem;
    margin: 1rem 0;
    text-align: center;
  }
  .visual-panel svg { display: block; margin: 0 auto; }

  .example {
    background: var(--green-light);
    border-left: 4px solid var(--green);
    border-radius: 0 8px 8px 0;
    padding: 1rem 1.3rem;
    margin: 1rem 0;
    font-size: 0.94rem;
  }
  .example strong { color: #1E8449; }

  .warning {
    background: var(--orange-light);
    border-left: 4px solid var(--orange);
    border-radius: 0 8px 8px 0;
    padding: 1rem 1.3rem;
    margin: 1rem 0;
    font-size: 0.94rem;
  }
  .warning strong { color: #B7600A; }

  .info {
    background: var(--blue-light);
    border-left: 4px solid var(--blue);
    border-radius: 0 8px 8px 0;
    padding: 1rem 1.3rem;
    margin: 1rem 0;
    font-size: 0.94rem;
  }
  .info strong { color: #1A5276; }

  .danger {
    background: var(--red-light);
    border-left: 4px solid var(--red);
    border-radius: 0 8px 8px 0;
    padding: 1rem 1.3rem;
    margin: 1rem 0;
    font-size: 0.94rem;
  }
  .danger strong { color: #922B21; }

  table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
    font-size: 0.92rem;
  }
  th {
    background: var(--purple);
    color: white;
    padding: 0.7rem 1rem;
    text-align: left;
    font-weight: 600;
  }
  td {
    padding: 0.6rem 1rem;
    border-bottom: 1px solid var(--border);
  }
  tr:nth-child(even) td { background: var(--purple-light); }

  .grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin: 1rem 0;
  }
  .mini-card {
    border-radius: 8px;
    padding: 1rem 1.2rem;
    font-size: 0.93rem;
  }
  .mini-card h4 {
    font-size: 0.9rem;
    font-weight: 700;
    margin-bottom: 0.4rem;
  }
  .mini-card.green { background: var(--green-light); border: 1px solid #A9DFBF; }
  .mini-card.green h4 { color: #1E8449; }
  .mini-card.orange { background: var(--orange-light); border: 1px solid #F5CBA7; }
  .mini-card.orange h4 { color: #B7600A; }
  .mini-card.blue { background: var(--blue-light); border: 1px solid #AED6F1; }
  .mini-card.blue h4 { color: #1A5276; }
  .mini-card.red { background: var(--red-light); border: 1px solid #F5B7B1; }
  .mini-card.red h4 { color: #922B21; }
  .mini-card.purple { background: var(--purple-light); border: 1px solid #D7BDE2; }
  .mini-card.purple h4 { color: var(--purple-dark); }

  .summary-card {
    background: #FFFDE7;
    border: 2px solid #F9E547;
    border-radius: 12px;
    padding: 1.5rem;
    margin-top: 2rem;
  }
  .summary-card h3 {
    color: #B8860B;
    font-size: 1.1rem;
    margin-bottom: 0.6rem;
  }

  footer {
    text-align: center;
    padding: 2rem;
    color: var(--text-light);
    font-size: 0.85rem;
    border-top: 1px solid var(--border);
  }

  @media (max-width: 600px) {
    header h1 { font-size: 1.6rem; }
    .container { padding: 1.2rem 1rem; }
    .toc-grid { grid-template-columns: 1fr; }
    .grid-2 { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<header>
  <div class="tag">CMM548 · Week 4 Pre-Reading</div>
  <h1>Key Concepts for Data Preprocessing</h1>
  <p>A visual guide to the techniques and vocabulary you'll use this week to transform raw data into model-ready features.</p>
</header>

<div class="container">

  <div class="intro-box">
    <strong>How to use this document:</strong> Skim the sections before the lecture so you recognise the terminology. Come back during the lab when you need a refresher. The visuals are designed to make abstract concepts concrete, so keep this page open alongside your notebook.
  </div>

  <!-- TABLE OF CONTENTS -->
  <div class="toc">
    <h3>Contents</h3>
    <div class="toc-grid">
      <a href="#s1"><span class="num">1</span> Feature Types</a>
      <a href="#s2"><span class="num">2</span> Imputation</a>
      <a href="#s3"><span class="num">3</span> One-Hot Encoding</a>
      <a href="#s4"><span class="num">4</span> Ordinal Encoding</a>
      <a href="#s5"><span class="num">5</span> Feature Scaling</a>
      <a href="#s6"><span class="num">6</span> SMOTE</a>
      <a href="#s7"><span class="num">7</span> Data Leakage</a>
      <a href="#s8"><span class="num">8</span> Pipelines &amp; ColumnTransformer</a>
      <a href="#s9"><span class="num">9</span> Quick Reference Table</a>
    </div>
  </div>


  <!-- ==================== 1. FEATURE TYPES ==================== -->
  <div class="concept" id="s1">
    <div class="concept-header">
      <div class="concept-num">1</div>
      <h2>Feature Types</h2>
    </div>
    <div class="concept-body">
      <p>Before you can preprocess your data, you need to know what <strong>type</strong> each feature is. The type determines which preprocessing steps are appropriate. There are three main types you'll work with.</p>

      <div class="visual-panel">
        <svg viewBox="0 0 740 340" xmlns="http://www.w3.org/2000/svg" style="max-width:700px;">
          <text x="370" y="24" text-anchor="middle" fill="#682773" font-weight="700" font-size="15" font-family="Source Sans 3, sans-serif">The Three Feature Types (with Bank Marketing examples)</text>

          <!-- NUMERICAL -->
          <rect x="30" y="50" width="210" height="265" rx="10" fill="#EBF5FB" stroke="#2980B9" stroke-width="2"/>
          <rect x="30" y="50" width="210" height="38" rx="10" fill="#2980B9"/>
          <rect x="30" y="72" width="210" height="16" fill="#2980B9"/>
          <text x="135" y="75" text-anchor="middle" fill="white" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">Numerical</text>

          <text x="135" y="110" text-anchor="middle" fill="#1A5276" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">Numbers you can do maths with.</text>
          <text x="135" y="128" text-anchor="middle" fill="#1A5276" font-size="11" font-family="Source Sans 3, sans-serif">Differences between values are</text>
          <text x="135" y="142" text-anchor="middle" fill="#1A5276" font-size="11" font-family="Source Sans 3, sans-serif">meaningful (e.g. age 40 is 10 more</text>
          <text x="135" y="156" text-anchor="middle" fill="#1A5276" font-size="11" font-family="Source Sans 3, sans-serif">than age 30).</text>

          <text x="135" y="182" text-anchor="middle" fill="#1A5276" font-weight="700" font-size="11" font-family="Source Sans 3, sans-serif">Examples:</text>
          <text x="135" y="200" text-anchor="middle" fill="#2C3E50" font-size="12" font-family="Source Code Pro, monospace">age</text>
          <text x="135" y="218" text-anchor="middle" fill="#5D6D7E" font-size="10" font-family="Source Sans 3, sans-serif">18, 33, 57, 42...</text>
          <text x="135" y="240" text-anchor="middle" fill="#2C3E50" font-size="12" font-family="Source Code Pro, monospace">balance</text>
          <text x="135" y="258" text-anchor="middle" fill="#5D6D7E" font-size="10" font-family="Source Sans 3, sans-serif">-102, 449, 1362, 8020...</text>

          <rect x="55" y="278" width="160" height="26" rx="5" fill="white" stroke="#2980B9" stroke-width="1"/>
          <text x="135" y="296" text-anchor="middle" fill="#1A5276" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">→ Scale, impute with median</text>

          <!-- ORDINAL -->
          <rect x="265" y="50" width="210" height="265" rx="10" fill="#FEF5EC" stroke="#E67E22" stroke-width="2"/>
          <rect x="265" y="50" width="210" height="38" rx="10" fill="#E67E22"/>
          <rect x="265" y="72" width="210" height="16" fill="#E67E22"/>
          <text x="370" y="75" text-anchor="middle" fill="white" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">Ordinal (categorical)</text>

          <text x="370" y="110" text-anchor="middle" fill="#B7600A" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">Categories with a natural order.</text>
          <text x="370" y="128" text-anchor="middle" fill="#B7600A" font-size="11" font-family="Source Sans 3, sans-serif">There's a ranking between values,</text>
          <text x="370" y="142" text-anchor="middle" fill="#B7600A" font-size="11" font-family="Source Sans 3, sans-serif">but the gaps between them may</text>
          <text x="370" y="156" text-anchor="middle" fill="#B7600A" font-size="11" font-family="Source Sans 3, sans-serif">not be equal.</text>

          <text x="370" y="182" text-anchor="middle" fill="#B7600A" font-weight="700" font-size="11" font-family="Source Sans 3, sans-serif">Examples:</text>
          <text x="370" y="200" text-anchor="middle" fill="#2C3E50" font-size="12" font-family="Source Code Pro, monospace">education</text>
          <text x="370" y="218" text-anchor="middle" fill="#5D6D7E" font-size="10" font-family="Source Sans 3, sans-serif">primary → secondary → tertiary</text>

          <rect x="290" y="278" width="160" height="26" rx="5" fill="white" stroke="#E67E22" stroke-width="1"/>
          <text x="370" y="296" text-anchor="middle" fill="#B7600A" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">→ Ordinal encode (0, 1, 2)</text>

          <!-- NOMINAL -->
          <rect x="500" y="50" width="210" height="265" rx="10" fill="#EAFAF1" stroke="#27AE60" stroke-width="2"/>
          <rect x="500" y="50" width="210" height="38" rx="10" fill="#27AE60"/>
          <rect x="500" y="72" width="210" height="16" fill="#27AE60"/>
          <text x="605" y="75" text-anchor="middle" fill="white" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">Nominal (categorical)</text>

          <text x="605" y="110" text-anchor="middle" fill="#1E8449" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">Categories with no order.</text>
          <text x="605" y="128" text-anchor="middle" fill="#1E8449" font-size="11" font-family="Source Sans 3, sans-serif">The values are just labels. There's</text>
          <text x="605" y="142" text-anchor="middle" fill="#1E8449" font-size="11" font-family="Source Sans 3, sans-serif">no sense in which one is "higher"</text>
          <text x="605" y="156" text-anchor="middle" fill="#1E8449" font-size="11" font-family="Source Sans 3, sans-serif">or "more" than another.</text>

          <text x="605" y="182" text-anchor="middle" fill="#1E8449" font-weight="700" font-size="11" font-family="Source Sans 3, sans-serif">Examples:</text>
          <text x="605" y="200" text-anchor="middle" fill="#2C3E50" font-size="12" font-family="Source Code Pro, monospace">job</text>
          <text x="605" y="218" text-anchor="middle" fill="#5D6D7E" font-size="10" font-family="Source Sans 3, sans-serif">admin, technician, student...</text>
          <text x="605" y="240" text-anchor="middle" fill="#2C3E50" font-size="12" font-family="Source Code Pro, monospace">marital</text>
          <text x="605" y="258" text-anchor="middle" fill="#5D6D7E" font-size="10" font-family="Source Sans 3, sans-serif">married, single, divorced</text>

          <rect x="525" y="278" width="160" height="26" rx="5" fill="white" stroke="#27AE60" stroke-width="1"/>
          <text x="605" y="296" text-anchor="middle" fill="#1E8449" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">→ One-hot encode</text>
        </svg>
      </div>

      <div class="warning">
        <strong>Why this matters:</strong> Using the wrong preprocessing for a feature type can mislead your model. If you ordinal-encode a nominal feature like <code>job</code>, the model will think "management" (5) is somehow "more" than "admin" (0). If you one-hot encode an ordinal feature like <code>education</code>, you lose the information that tertiary > secondary > primary.
      </div>

      <div class="info">
        <strong>How to identify the type:</strong> Look at the values. Can you do maths with them (add, subtract, average)? It's numerical. Are they categories with a clear ranking? Ordinal. Categories with no ranking? Nominal. Some features need judgement, so always justify your choice.
      </div>
    </div>
  </div>


  <!-- ==================== 2. IMPUTATION ==================== -->
  <div class="concept" id="s2">
    <div class="concept-header">
      <div class="concept-num">2</div>
      <h2>Imputation</h2>
    </div>
    <div class="concept-body">
      <p><span class="key-term">Imputation</span> means filling in missing values with estimated replacements. The right strategy depends on what kind of data is missing and why.</p>

      <div class="visual-panel">
        <svg viewBox="0 0 740 370" xmlns="http://www.w3.org/2000/svg" style="max-width:700px;">
          <text x="370" y="25" text-anchor="middle" fill="#682773" font-weight="700" font-size="15" font-family="Source Sans 3, sans-serif">Choosing an Imputation Strategy</text>

          <!-- Start node -->
          <rect x="270" y="45" width="200" height="36" rx="18" fill="#682773" stroke="none"/>
          <text x="370" y="68" text-anchor="middle" fill="white" font-weight="600" font-size="13" font-family="Source Sans 3, sans-serif">Feature has missing values</text>

          <!-- Arrow down -->
          <line x1="370" y1="81" x2="370" y2="105" stroke="#682773" stroke-width="2" marker-end="url(#arrowPurple)"/>

          <!-- Decision: how much? -->
          <polygon points="370,105 480,145 370,185 260,145" fill="#F7ECF8" stroke="#682773" stroke-width="2"/>
          <text x="370" y="142" text-anchor="middle" fill="#4A1A52" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">&gt;50% missing?</text>
          <text x="370" y="156" text-anchor="middle" fill="#4A1A52" font-size="11" font-family="Source Sans 3, sans-serif">&amp; not critical</text>

          <!-- Yes: drop feature -->
          <line x1="480" y1="145" x2="570" y2="145" stroke="#E74C3C" stroke-width="2" marker-end="url(#arrowRed)"/>
          <text x="520" y="138" text-anchor="middle" fill="#E74C3C" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">Yes</text>
          <rect x="572" y="127" width="145" height="36" rx="8" fill="#FDEDEC" stroke="#E74C3C" stroke-width="1.5"/>
          <text x="644" y="150" text-anchor="middle" fill="#922B21" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">Drop the feature</text>

          <!-- No: continue -->
          <line x1="370" y1="185" x2="370" y2="210" stroke="#682773" stroke-width="2" marker-end="url(#arrowPurple)"/>
          <text x="382" y="200" fill="#682773" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">No</text>

          <!-- Decision: numerical or categorical? -->
          <polygon points="370,210 490,250 370,290 250,250" fill="#F7ECF8" stroke="#682773" stroke-width="2"/>
          <text x="370" y="253" text-anchor="middle" fill="#4A1A52" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">Numerical or</text>
          <text x="370" y="267" text-anchor="middle" fill="#4A1A52" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">categorical?</text>

          <!-- Left: numerical -->
          <line x1="250" y1="250" x2="140" y2="250" stroke="#2980B9" stroke-width="2" marker-end="url(#arrowBlue)"/>
          <text x="195" y="243" text-anchor="middle" fill="#2980B9" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">Numerical</text>
          <rect x="15" y="225" width="123" height="50" rx="8" fill="#EBF5FB" stroke="#2980B9" stroke-width="1.5"/>
          <text x="76" y="246" text-anchor="middle" fill="#1A5276" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">Median (skewed)</text>
          <text x="76" y="262" text-anchor="middle" fill="#1A5276" font-size="11" font-family="Source Sans 3, sans-serif">or Mean (symmetric)</text>

          <!-- Right: categorical -->
          <line x1="490" y1="250" x2="570" y2="250" stroke="#27AE60" stroke-width="2" marker-end="url(#arrowGreen)"/>
          <text x="530" y="243" text-anchor="middle" fill="#27AE60" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">Categorical</text>
          <rect x="572" y="225" width="150" height="50" rx="8" fill="#EAFAF1" stroke="#27AE60" stroke-width="1.5"/>
          <text x="647" y="246" text-anchor="middle" fill="#1E8449" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">Mode (most frequent)</text>
          <text x="647" y="262" text-anchor="middle" fill="#1E8449" font-size="11" font-family="Source Sans 3, sans-serif">or keep "unknown"</text>

          <!-- Bottom note -->
          <rect x="165" y="315" width="410" height="42" rx="8" fill="#FEF5EC" stroke="#E67E22" stroke-width="1.5"/>
          <text x="370" y="335" text-anchor="middle" fill="#B7600A" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">If missingness is informative → create an indicator column</text>
          <text x="370" y="350" text-anchor="middle" fill="#B7600A" font-size="11" font-family="Source Sans 3, sans-serif">(a binary flag: was this value originally missing?)</text>
          <line x1="370" y1="290" x2="370" y2="315" stroke="#E67E22" stroke-width="1.5" stroke-dasharray="5,4"/>

          <!-- Arrow markers -->
          <defs>
            <marker id="arrowPurple" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#682773"/></marker>
            <marker id="arrowRed" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#E74C3C"/></marker>
            <marker id="arrowBlue" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#2980B9"/></marker>
            <marker id="arrowGreen" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#27AE60"/></marker>
          </defs>
        </svg>
      </div>

      <!-- Before/after imputation visuals -->
      <div class="grid-2">
        <div class="visual-panel" style="padding:0.8rem;">
          <svg viewBox="0 0 320 280" xmlns="http://www.w3.org/2000/svg" style="max-width:300px;">
            <text x="160" y="18" text-anchor="middle" fill="#2980B9" font-weight="700" font-size="13" font-family="Source Sans 3, sans-serif">Median Imputation (numerical)</text>

            <!-- Before column -->
            <text x="80" y="42" text-anchor="middle" fill="#5D6D7E" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">Before</text>
            <rect x="30" y="50" width="100" height="24" rx="3" fill="#682773"/>
            <text x="80" y="67" text-anchor="middle" fill="white" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">balance</text>
            <rect x="30" y="74" width="100" height="22" fill="#EBF5FB" stroke="#E8E8E8" stroke-width="1"/>
            <text x="80" y="89" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">1200</text>
            <rect x="30" y="96" width="100" height="22" fill="white" stroke="#E8E8E8" stroke-width="1"/>
            <text x="80" y="111" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">350</text>
            <rect x="30" y="118" width="100" height="22" fill="#FDEDEC" stroke="#E74C3C" stroke-width="1.5"/>
            <text x="80" y="133" text-anchor="middle" fill="#E74C3C" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">NaN</text>
            <rect x="30" y="140" width="100" height="22" fill="white" stroke="#E8E8E8" stroke-width="1"/>
            <text x="80" y="155" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">449</text>
            <rect x="30" y="162" width="100" height="22" fill="#EBF5FB" stroke="#E8E8E8" stroke-width="1"/>
            <text x="80" y="177" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">8020</text>
            <rect x="30" y="184" width="100" height="22" fill="#FDEDEC" stroke="#E74C3C" stroke-width="1.5"/>
            <text x="80" y="199" text-anchor="middle" fill="#E74C3C" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">NaN</text>

            <!-- Arrow -->
            <text x="160" y="145" text-anchor="middle" fill="#682773" font-size="18">→</text>

            <!-- After column -->
            <text x="240" y="42" text-anchor="middle" fill="#5D6D7E" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">After</text>
            <rect x="190" y="50" width="100" height="24" rx="3" fill="#682773"/>
            <text x="240" y="67" text-anchor="middle" fill="white" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">balance</text>
            <rect x="190" y="74" width="100" height="22" fill="#EBF5FB" stroke="#E8E8E8" stroke-width="1"/>
            <text x="240" y="89" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">1200</text>
            <rect x="190" y="96" width="100" height="22" fill="white" stroke="#E8E8E8" stroke-width="1"/>
            <text x="240" y="111" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">350</text>
            <rect x="190" y="118" width="100" height="22" fill="#EBF5FB" stroke="#2980B9" stroke-width="1.5"/>
            <text x="240" y="133" text-anchor="middle" fill="#2980B9" font-weight="700" font-size="11" font-family="Source Code Pro, monospace">449</text>
            <rect x="190" y="140" width="100" height="22" fill="white" stroke="#E8E8E8" stroke-width="1"/>
            <text x="240" y="155" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">449</text>
            <rect x="190" y="162" width="100" height="22" fill="#EBF5FB" stroke="#E8E8E8" stroke-width="1"/>
            <text x="240" y="177" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">8020</text>
            <rect x="190" y="184" width="100" height="22" fill="#EBF5FB" stroke="#2980B9" stroke-width="1.5"/>
            <text x="240" y="199" text-anchor="middle" fill="#2980B9" font-weight="700" font-size="11" font-family="Source Code Pro, monospace">449</text>

            <!-- Explanation -->
            <rect x="30" y="222" width="260" height="48" rx="6" fill="#EBF5FB" stroke="#2980B9" stroke-width="1"/>
            <text x="160" y="240" text-anchor="middle" fill="#1A5276" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">Sorted values: 350, 449, 1200, 8020</text>
            <text x="160" y="258" text-anchor="middle" fill="#1A5276" font-size="11" font-family="Source Sans 3, sans-serif">Median = middle value = <tspan font-weight="700">449</tspan></text>
          </svg>
        </div>

        <div class="visual-panel" style="padding:0.8rem;">
          <svg viewBox="0 0 320 280" xmlns="http://www.w3.org/2000/svg" style="max-width:300px;">
            <text x="160" y="18" text-anchor="middle" fill="#27AE60" font-weight="700" font-size="13" font-family="Source Sans 3, sans-serif">Mode Imputation (categorical)</text>

            <!-- Before column -->
            <text x="80" y="42" text-anchor="middle" fill="#5D6D7E" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">Before</text>
            <rect x="30" y="50" width="100" height="24" rx="3" fill="#682773"/>
            <text x="80" y="67" text-anchor="middle" fill="white" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">job</text>
            <rect x="30" y="74" width="100" height="22" fill="#EAFAF1" stroke="#E8E8E8" stroke-width="1"/>
            <text x="80" y="89" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">admin</text>
            <rect x="30" y="96" width="100" height="22" fill="white" stroke="#E8E8E8" stroke-width="1"/>
            <text x="80" y="111" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">admin</text>
            <rect x="30" y="118" width="100" height="22" fill="#FDEDEC" stroke="#E74C3C" stroke-width="1.5"/>
            <text x="80" y="133" text-anchor="middle" fill="#E74C3C" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">NaN</text>
            <rect x="30" y="140" width="100" height="22" fill="white" stroke="#E8E8E8" stroke-width="1"/>
            <text x="80" y="155" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">student</text>
            <rect x="30" y="162" width="100" height="22" fill="#EAFAF1" stroke="#E8E8E8" stroke-width="1"/>
            <text x="80" y="177" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">admin</text>
            <rect x="30" y="184" width="100" height="22" fill="#FDEDEC" stroke="#E74C3C" stroke-width="1.5"/>
            <text x="80" y="199" text-anchor="middle" fill="#E74C3C" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">NaN</text>

            <!-- Arrow -->
            <text x="160" y="145" text-anchor="middle" fill="#682773" font-size="18">→</text>

            <!-- After column -->
            <text x="240" y="42" text-anchor="middle" fill="#5D6D7E" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">After</text>
            <rect x="190" y="50" width="100" height="24" rx="3" fill="#682773"/>
            <text x="240" y="67" text-anchor="middle" fill="white" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">job</text>
            <rect x="190" y="74" width="100" height="22" fill="#EAFAF1" stroke="#E8E8E8" stroke-width="1"/>
            <text x="240" y="89" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">admin</text>
            <rect x="190" y="96" width="100" height="22" fill="white" stroke="#E8E8E8" stroke-width="1"/>
            <text x="240" y="111" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">admin</text>
            <rect x="190" y="118" width="100" height="22" fill="#EAFAF1" stroke="#27AE60" stroke-width="1.5"/>
            <text x="240" y="133" text-anchor="middle" fill="#27AE60" font-weight="700" font-size="11" font-family="Source Code Pro, monospace">admin</text>
            <rect x="190" y="140" width="100" height="22" fill="white" stroke="#E8E8E8" stroke-width="1"/>
            <text x="240" y="155" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">student</text>
            <rect x="190" y="162" width="100" height="22" fill="#EAFAF1" stroke="#E8E8E8" stroke-width="1"/>
            <text x="240" y="177" text-anchor="middle" fill="#2C3E50" font-size="11" font-family="Source Code Pro, monospace">admin</text>
            <rect x="190" y="184" width="100" height="22" fill="#EAFAF1" stroke="#27AE60" stroke-width="1.5"/>
            <text x="240" y="199" text-anchor="middle" fill="#27AE60" font-weight="700" font-size="11" font-family="Source Code Pro, monospace">admin</text>

            <!-- Explanation -->
            <rect x="30" y="222" width="260" height="48" rx="6" fill="#EAFAF1" stroke="#27AE60" stroke-width="1"/>
            <text x="160" y="240" text-anchor="middle" fill="#1E8449" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">Counts: admin (3), student (1)</text>
            <text x="160" y="258" text-anchor="middle" fill="#1E8449" font-size="11" font-family="Source Sans 3, sans-serif">Mode = most frequent = <tspan font-weight="700">admin</tspan></text>
          </svg>
        </div>
      </div>

      <div class="grid-2">
        <div class="mini-card blue">
          <h4>Mean vs. Median?</h4>
          If the distribution is <strong>symmetric</strong>, either works. If it's <strong>skewed or has outliers</strong>, use the median, since it isn't pulled by extreme values.
        </div>
        <div class="mini-card orange">
          <h4>Encoded missingness</h4>
          Values like <code>"unknown"</code> or <code>-1</code> aren't detected by <code>isnull()</code>. You must handle these explicitly based on what you found in Week 3.
        </div>
      </div>

      <div class="example">
        <strong>Bank Marketing example:</strong> The <code>balance</code> feature has a mean of £1,362 but a median of only £449. The mean is inflated by high-balance outliers. If you imputed missing balances with the mean, you'd fill every gap with an unusually high value. Median is the safer choice here.
      </div>
    </div>
  </div>


  <!-- ==================== 3. ONE-HOT ENCODING ==================== -->
  <div class="concept" id="s3">
    <div class="concept-header">
      <div class="concept-num">3</div>
      <h2>One-Hot Encoding</h2>
    </div>
    <div class="concept-body">
      <p><span class="key-term">One-hot encoding</span> converts a categorical feature into multiple binary (0/1) columns, one per category. Use it for <strong>nominal</strong> features (categories with no natural order).</p>

      <div class="visual-panel">
        <svg viewBox="0 0 740 260" xmlns="http://www.w3.org/2000/svg" style="max-width:700px;">
          <text x="370" y="22" text-anchor="middle" fill="#682773" font-weight="700" font-size="15" font-family="Source Sans 3, sans-serif">One-Hot Encoding: marital status</text>

          <!-- Original column -->
          <rect x="50" y="45" width="130" height="30" rx="4" fill="#682773"/>
          <text x="115" y="65" text-anchor="middle" fill="white" font-weight="600" font-size="13" font-family="Source Sans 3, sans-serif">marital</text>

          <rect x="50" y="78" width="130" height="28" fill="#F7ECF8" stroke="#E8E8E8" stroke-width="1"/>
          <text x="115" y="97" text-anchor="middle" fill="#4A1A52" font-size="13" font-family="Source Sans 3, sans-serif">married</text>
          <rect x="50" y="106" width="130" height="28" fill="white" stroke="#E8E8E8" stroke-width="1"/>
          <text x="115" y="125" text-anchor="middle" fill="#4A1A52" font-size="13" font-family="Source Sans 3, sans-serif">single</text>
          <rect x="50" y="134" width="130" height="28" fill="#F7ECF8" stroke="#E8E8E8" stroke-width="1"/>
          <text x="115" y="153" text-anchor="middle" fill="#4A1A52" font-size="13" font-family="Source Sans 3, sans-serif">divorced</text>
          <rect x="50" y="162" width="130" height="28" fill="white" stroke="#E8E8E8" stroke-width="1"/>
          <text x="115" y="181" text-anchor="middle" fill="#4A1A52" font-size="13" font-family="Source Sans 3, sans-serif">married</text>

          <!-- Arrow -->
          <line x1="195" y1="130" x2="270" y2="130" stroke="#682773" stroke-width="2.5" marker-end="url(#arrowP2)"/>
          <text x="233" y="122" text-anchor="middle" fill="#682773" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">encode</text>

          <!-- Encoded columns -->
          <rect x="285" y="45" width="130" height="30" rx="4" fill="#2980B9"/>
          <text x="350" y="65" text-anchor="middle" fill="white" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">is_married</text>
          <rect x="420" y="45" width="130" height="30" rx="4" fill="#27AE60"/>
          <text x="485" y="65" text-anchor="middle" fill="white" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">is_single</text>
          <rect x="555" y="45" width="130" height="30" rx="4" fill="#E67E22"/>
          <text x="620" y="65" text-anchor="middle" fill="white" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">is_divorced</text>

          <!-- Row 1: married -->
          <rect x="285" y="78" width="130" height="28" fill="#EBF5FB" stroke="#E8E8E8" stroke-width="1"/>
          <text x="350" y="97" text-anchor="middle" fill="#1A5276" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">1</text>
          <rect x="420" y="78" width="130" height="28" fill="#EAFAF1" stroke="#E8E8E8" stroke-width="1"/>
          <text x="485" y="97" text-anchor="middle" fill="#5D6D7E" font-size="14" font-family="Source Sans 3, sans-serif">0</text>
          <rect x="555" y="78" width="130" height="28" fill="#FEF5EC" stroke="#E8E8E8" stroke-width="1"/>
          <text x="620" y="97" text-anchor="middle" fill="#5D6D7E" font-size="14" font-family="Source Sans 3, sans-serif">0</text>

          <!-- Row 2: single -->
          <rect x="285" y="106" width="130" height="28" fill="white" stroke="#E8E8E8" stroke-width="1"/>
          <text x="350" y="125" text-anchor="middle" fill="#5D6D7E" font-size="14" font-family="Source Sans 3, sans-serif">0</text>
          <rect x="420" y="106" width="130" height="28" fill="white" stroke="#E8E8E8" stroke-width="1"/>
          <text x="485" y="125" text-anchor="middle" fill="#1E8449" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">1</text>
          <rect x="555" y="106" width="130" height="28" fill="white" stroke="#E8E8E8" stroke-width="1"/>
          <text x="620" y="125" text-anchor="middle" fill="#5D6D7E" font-size="14" font-family="Source Sans 3, sans-serif">0</text>

          <!-- Row 3: divorced -->
          <rect x="285" y="134" width="130" height="28" fill="#EBF5FB" stroke="#E8E8E8" stroke-width="1"/>
          <text x="350" y="153" text-anchor="middle" fill="#5D6D7E" font-size="14" font-family="Source Sans 3, sans-serif">0</text>
          <rect x="420" y="134" width="130" height="28" fill="#EAFAF1" stroke="#E8E8E8" stroke-width="1"/>
          <text x="485" y="153" text-anchor="middle" fill="#5D6D7E" font-size="14" font-family="Source Sans 3, sans-serif">0</text>
          <rect x="555" y="134" width="130" height="28" fill="#FEF5EC" stroke="#E8E8E8" stroke-width="1"/>
          <text x="620" y="153" text-anchor="middle" fill="#B7600A" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">1</text>

          <!-- Row 4: married -->
          <rect x="285" y="162" width="130" height="28" fill="white" stroke="#E8E8E8" stroke-width="1"/>
          <text x="350" y="181" text-anchor="middle" fill="#1A5276" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">1</text>
          <rect x="420" y="162" width="130" height="28" fill="white" stroke="#E8E8E8" stroke-width="1"/>
          <text x="485" y="181" text-anchor="middle" fill="#5D6D7E" font-size="14" font-family="Source Sans 3, sans-serif">0</text>
          <rect x="555" y="162" width="130" height="28" fill="white" stroke="#E8E8E8" stroke-width="1"/>
          <text x="620" y="181" text-anchor="middle" fill="#5D6D7E" font-size="14" font-family="Source Sans 3, sans-serif">0</text>

          <!-- drop_first note -->
          <rect x="180" y="210" width="380" height="40" rx="8" fill="#EBF5FB" stroke="#2980B9" stroke-width="1.5"/>
          <text x="370" y="228" text-anchor="middle" fill="#1A5276" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">With drop_first=True, one column is removed (it's redundant).</text>
          <text x="370" y="243" text-anchor="middle" fill="#1A5276" font-size="11" font-family="Source Sans 3, sans-serif">If is_married=0 and is_single=0, the person must be divorced.</text>

          <defs><marker id="arrowP2" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#682773"/></marker></defs>
        </svg>
      </div>

      <div class="warning">
        <strong>When not to use one-hot encoding:</strong> If categories have a natural order (like education: primary → secondary → tertiary), one-hot encoding throws away that ordering. Use ordinal encoding instead (see next section).
      </div>
    </div>
  </div>


  <!-- ==================== 4. ORDINAL ENCODING ==================== -->
  <div class="concept" id="s4">
    <div class="concept-header">
      <div class="concept-num">4</div>
      <h2>Ordinal Encoding</h2>
    </div>
    <div class="concept-body">
      <p><span class="key-term">Ordinal encoding</span> assigns integers to categories that have a <strong>meaningful order</strong>. The numbers reflect the ranking, so a higher number means a "higher" level.</p>

      <div class="visual-panel">
        <svg viewBox="0 0 740 170" xmlns="http://www.w3.org/2000/svg" style="max-width:700px;">
          <text x="370" y="22" text-anchor="middle" fill="#682773" font-weight="700" font-size="15" font-family="Source Sans 3, sans-serif">Ordinal Encoding: education level</text>

          <!-- Category boxes with arrows -->
          <rect x="40" y="55" width="130" height="50" rx="10" fill="#FDEDEC" stroke="#E74C3C" stroke-width="2"/>
          <text x="105" y="78" text-anchor="middle" fill="#922B21" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">primary</text>
          <text x="105" y="96" text-anchor="middle" fill="#922B21" font-weight="700" font-size="20" font-family="Source Sans 3, sans-serif">0</text>

          <text x="195" y="83" text-anchor="middle" fill="#BDC3C7" font-size="22" font-family="Source Sans 3, sans-serif">→</text>

          <rect x="220" y="55" width="130" height="50" rx="10" fill="#FEF5EC" stroke="#E67E22" stroke-width="2"/>
          <text x="285" y="78" text-anchor="middle" fill="#B7600A" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">secondary</text>
          <text x="285" y="96" text-anchor="middle" fill="#B7600A" font-weight="700" font-size="20" font-family="Source Sans 3, sans-serif">1</text>

          <text x="375" y="83" text-anchor="middle" fill="#BDC3C7" font-size="22" font-family="Source Sans 3, sans-serif">→</text>

          <rect x="400" y="55" width="130" height="50" rx="10" fill="#EAFAF1" stroke="#27AE60" stroke-width="2"/>
          <text x="465" y="78" text-anchor="middle" fill="#1E8449" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">tertiary</text>
          <text x="465" y="96" text-anchor="middle" fill="#1E8449" font-weight="700" font-size="20" font-family="Source Sans 3, sans-serif">2</text>

          <!-- Scale bar underneath -->
          <line x1="105" y1="120" x2="465" y2="120" stroke="#682773" stroke-width="2"/>
          <line x1="105" y1="115" x2="105" y2="125" stroke="#682773" stroke-width="2"/>
          <line x1="465" y1="115" x2="465" y2="125" stroke="#682773" stroke-width="2"/>
          <text x="285" y="140" text-anchor="middle" fill="#5D6D7E" font-size="12" font-family="Source Sans 3, sans-serif">Order is preserved: 0 &lt; 1 &lt; 2</text>
          <text x="285" y="156" text-anchor="middle" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">(but spacing between levels is assumed equal, so keep this in mind)</text>
        </svg>
      </div>

      <div class="info">
        <strong>Key difference from one-hot:</strong> Ordinal encoding produces a single column with meaningful numeric order. One-hot encoding produces multiple binary columns with no implied order. Choose based on whether the categories have a natural ranking.
      </div>
    </div>
  </div>


  <!-- ==================== 5. FEATURE SCALING ==================== -->
  <div class="concept" id="s5">
    <div class="concept-header">
      <div class="concept-num">5</div>
      <h2>Feature Scaling</h2>
    </div>
    <div class="concept-body">
      <p><span class="key-term">Feature scaling</span> transforms numerical features so they're on comparable scales. Without it, features with large ranges (like income) dominate distance calculations over features with small ranges (like age).</p>

      <div class="visual-panel">
        <svg viewBox="0 0 740 310" xmlns="http://www.w3.org/2000/svg" style="max-width:700px;">
          <text x="370" y="22" text-anchor="middle" fill="#682773" font-weight="700" font-size="15" font-family="Source Sans 3, sans-serif">Before vs. After Scaling</text>

          <!-- BEFORE -->
          <text x="185" y="52" text-anchor="middle" fill="#E74C3C" font-weight="700" font-size="13" font-family="Source Sans 3, sans-serif">Before scaling</text>

          <text x="60" y="82" text-anchor="end" fill="#5D6D7E" font-size="12" font-family="Source Sans 3, sans-serif">age</text>
          <rect x="70" y="70" width="30" height="18" rx="3" fill="#2980B9" opacity="0.7"/>
          <text x="110" y="83" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">18 to 95</text>

          <text x="60" y="112" text-anchor="end" fill="#5D6D7E" font-size="12" font-family="Source Sans 3, sans-serif">balance</text>
          <rect x="70" y="100" width="230" height="18" rx="3" fill="#E67E22" opacity="0.7"/>
          <text x="310" y="113" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">-8,019 to 102,127</text>

          <text x="60" y="142" text-anchor="end" fill="#5D6D7E" font-size="12" font-family="Source Sans 3, sans-serif">campaign</text>
          <rect x="70" y="130" width="80" height="18" rx="3" fill="#27AE60" opacity="0.7"/>
          <text x="160" y="143" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">1 to 63</text>

          <text x="185" y="172" text-anchor="middle" fill="#E74C3C" font-size="11" font-family="Source Sans 3, sans-serif">Balance completely dominates distance calculations!</text>

          <!-- AFTER -->
          <text x="555" y="52" text-anchor="middle" fill="#27AE60" font-weight="700" font-size="13" font-family="Source Sans 3, sans-serif">After StandardScaler</text>

          <text x="445" y="82" text-anchor="end" fill="#5D6D7E" font-size="12" font-family="Source Sans 3, sans-serif">age</text>
          <rect x="455" y="70" width="140" height="18" rx="3" fill="#2980B9" opacity="0.7"/>
          <text x="605" y="83" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">approx. -2 to +3</text>

          <text x="445" y="112" text-anchor="end" fill="#5D6D7E" font-size="12" font-family="Source Sans 3, sans-serif">balance</text>
          <rect x="455" y="100" width="155" height="18" rx="3" fill="#E67E22" opacity="0.7"/>
          <text x="620" y="113" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">approx. -1 to +4</text>

          <text x="445" y="142" text-anchor="end" fill="#5D6D7E" font-size="12" font-family="Source Sans 3, sans-serif">campaign</text>
          <rect x="455" y="130" width="130" height="18" rx="3" fill="#27AE60" opacity="0.7"/>
          <text x="595" y="143" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">approx. -1 to +3</text>

          <text x="555" y="172" text-anchor="middle" fill="#27AE60" font-size="11" font-family="Source Sans 3, sans-serif">All features now on comparable scales ✓</text>

          <!-- Comparison boxes -->
          <rect x="40" y="200" width="320" height="95" rx="8" fill="#EBF5FB" stroke="#2980B9" stroke-width="1.5"/>
          <text x="200" y="222" text-anchor="middle" fill="#1A5276" font-weight="700" font-size="13" font-family="Source Sans 3, sans-serif">StandardScaler (Z-score)</text>
          <text x="200" y="242" text-anchor="middle" fill="#2C3E50" font-size="12" font-family="Source Sans 3, sans-serif">x′ = (x − mean) / std</text>
          <text x="200" y="260" text-anchor="middle" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">Result: mean = 0, std = 1</text>
          <text x="200" y="278" text-anchor="middle" fill="#1A5276" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">✓ Robust to outliers. Use this by default.</text>

          <rect x="380" y="200" width="320" height="95" rx="8" fill="#FEF5EC" stroke="#E67E22" stroke-width="1.5"/>
          <text x="540" y="222" text-anchor="middle" fill="#B7600A" font-weight="700" font-size="13" font-family="Source Sans 3, sans-serif">MinMaxScaler (Normalisation)</text>
          <text x="540" y="242" text-anchor="middle" fill="#2C3E50" font-size="12" font-family="Source Sans 3, sans-serif">x′ = (x − min) / (max − min)</text>
          <text x="540" y="260" text-anchor="middle" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">Result: values in [0, 1]</text>
          <text x="540" y="278" text-anchor="middle" fill="#B7600A" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">⚠ Sensitive to outliers. One extreme compresses all.</text>
        </svg>
      </div>

      <div class="info">
        <strong>Which models need scaling?</strong> Distance-based models (k-NN, SVM) and gradient-based models (Logistic Regression) need it. Tree-based models (Decision Trees, Random Forest) do not, because they split on thresholds rather than distances.
      </div>
    </div>
  </div>


  <!-- ==================== 6. SMOTE ==================== -->
  <div class="concept" id="s6">
    <div class="concept-header">
      <div class="concept-num">6</div>
      <h2>SMOTE</h2>
    </div>
    <div class="concept-body">
      <p><span class="key-term">SMOTE</span> (Synthetic Minority Over-sampling Technique) creates new, synthetic examples of the minority class to address <strong>class imbalance</strong>. Instead of duplicating existing data points, it generates new ones by interpolating between existing minority neighbours.</p>

      <div class="visual-panel">
        <svg viewBox="0 0 740 340" xmlns="http://www.w3.org/2000/svg" style="max-width:700px;">
          <text x="370" y="22" text-anchor="middle" fill="#682773" font-weight="700" font-size="15" font-family="Source Sans 3, sans-serif">How SMOTE Creates Synthetic Samples</text>

          <!-- Axes -->
          <line x1="80" y1="290" x2="680" y2="290" stroke="#BDC3C7" stroke-width="1.5"/>
          <line x1="80" y1="290" x2="80" y2="50" stroke="#BDC3C7" stroke-width="1.5"/>
          <text x="380" y="320" text-anchor="middle" fill="#5D6D7E" font-size="12" font-family="Source Sans 3, sans-serif">Feature 1 (e.g. age)</text>
          <text x="40" y="170" text-anchor="middle" fill="#5D6D7E" font-size="12" font-family="Source Sans 3, sans-serif" transform="rotate(-90,40,170)">Feature 2 (e.g. balance)</text>

          <!-- Majority class points (grey) -->
          <circle cx="200" cy="100" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="250" cy="80" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="180" cy="130" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="230" cy="150" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="270" cy="110" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="160" cy="90" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="210" cy="160" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="290" cy="90" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="240" cy="170" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="150" cy="120" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="300" cy="140" r="8" fill="#BDC3C7" opacity="0.5"/>
          <circle cx="190" cy="70" r="8" fill="#BDC3C7" opacity="0.5"/>

          <!-- Minority class points (purple) -->
          <circle cx="480" cy="220" r="10" fill="#682773" stroke="white" stroke-width="2"/>
          <circle cx="560" cy="180" r="10" fill="#682773" stroke="white" stroke-width="2"/>
          <circle cx="520" cy="250" r="10" fill="#682773" stroke="white" stroke-width="2"/>

          <!-- Interpolation line -->
          <line x1="480" y1="220" x2="560" y2="180" stroke="#9B59B6" stroke-width="2" stroke-dasharray="6,4"/>

          <!-- Synthetic point -->
          <circle cx="515" cy="202" r="10" fill="#E74C3C" stroke="white" stroke-width="2"/>

          <!-- Labels -->
          <text x="480" y="210" text-anchor="end" fill="#4A1A52" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">Point A</text>
          <text x="572" y="175" fill="#4A1A52" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">Point B</text>
          <text x="525" y="210" fill="#E74C3C" font-weight="600" font-size="11" font-family="Source Sans 3, sans-serif">new!</text>

          <!-- Legend -->
          <circle cx="120" cy="330" r="6" fill="#BDC3C7" opacity="0.6"/>
          <text x="133" y="334" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">Majority class (no subscription)</text>
          <circle cx="340" cy="330" r="6" fill="#682773"/>
          <text x="353" y="334" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">Minority class (subscribed)</text>
          <circle cx="540" cy="330" r="6" fill="#E74C3C"/>
          <text x="553" y="334" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">Synthetic (SMOTE-generated)</text>
        </svg>
      </div>

      <div class="danger">
        <strong>Critical rule:</strong> Only apply SMOTE to the <strong>training set</strong>. Never resample the test set. It must reflect real-world class proportions, otherwise your evaluation metrics are meaningless.
      </div>

      <div class="grid-2">
        <div class="mini-card green">
          <h4>Why not just duplicate?</h4>
          Random oversampling copies existing points exactly, so the model can memorise them. SMOTE creates <em>new</em> points in the minority region, giving the model more variety to learn from.
        </div>
        <div class="mini-card purple">
          <h4>Alternatives</h4>
          <strong>Class weights:</strong> Penalise majority-class errors more heavily without changing the data at all. Set <code>class_weight='balanced'</code> in scikit-learn.
        </div>
      </div>
    </div>
  </div>


  <!-- ==================== 7. DATA LEAKAGE ==================== -->
  <div class="concept" id="s7">
    <div class="concept-header">
      <div class="concept-num">7</div>
      <h2>Data Leakage</h2>
    </div>
    <div class="concept-body">
      <p><span class="key-term">Data leakage</span> happens when information from outside the training set influences how your model is built. The result is that metrics look great in evaluation, but the model fails on genuinely new data.</p>

      <div class="visual-panel">
        <svg viewBox="0 0 740 320" xmlns="http://www.w3.org/2000/svg" style="max-width:700px;">
          <text x="370" y="22" text-anchor="middle" fill="#682773" font-weight="700" font-size="15" font-family="Source Sans 3, sans-serif">Correct vs. Incorrect Preprocessing Order</text>

          <!-- WRONG -->
          <rect x="30" y="50" width="330" height="245" rx="10" fill="#FDEDEC" stroke="#E74C3C" stroke-width="2"/>
          <text x="195" y="75" text-anchor="middle" fill="#922B21" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">✗ Wrong (leakage!)</text>

          <rect x="65" y="92" width="260" height="32" rx="6" fill="white" stroke="#E74C3C" stroke-width="1.5"/>
          <text x="195" y="113" text-anchor="middle" fill="#922B21" font-size="12" font-family="Source Sans 3, sans-serif">1. Fit scaler on ALL data</text>

          <text x="195" y="137" text-anchor="middle" fill="#E74C3C" font-size="14">↓</text>

          <rect x="65" y="145" width="260" height="32" rx="6" fill="white" stroke="#E74C3C" stroke-width="1.5"/>
          <text x="195" y="166" text-anchor="middle" fill="#922B21" font-size="12" font-family="Source Sans 3, sans-serif">2. Transform ALL data</text>

          <text x="195" y="190" text-anchor="middle" fill="#E74C3C" font-size="14">↓</text>

          <rect x="65" y="198" width="260" height="32" rx="6" fill="white" stroke="#E74C3C" stroke-width="1.5"/>
          <text x="195" y="219" text-anchor="middle" fill="#922B21" font-size="12" font-family="Source Sans 3, sans-serif">3. Split into train / test</text>

          <text x="195" y="255" text-anchor="middle" fill="#922B21" font-size="11" font-family="Source Sans 3, sans-serif">Training data "knows" test set statistics!</text>
          <text x="195" y="272" text-anchor="middle" fill="#922B21" font-size="11" font-family="Source Sans 3, sans-serif">Metrics are optimistically biased.</text>

          <!-- RIGHT -->
          <rect x="380" y="50" width="330" height="245" rx="10" fill="#EAFAF1" stroke="#27AE60" stroke-width="2"/>
          <text x="545" y="75" text-anchor="middle" fill="#1E8449" font-weight="700" font-size="14" font-family="Source Sans 3, sans-serif">✓ Correct</text>

          <rect x="415" y="92" width="260" height="32" rx="6" fill="white" stroke="#27AE60" stroke-width="1.5"/>
          <text x="545" y="113" text-anchor="middle" fill="#1E8449" font-size="12" font-family="Source Sans 3, sans-serif">1. Split into train / test</text>

          <text x="545" y="137" text-anchor="middle" fill="#27AE60" font-size="14">↓</text>

          <rect x="415" y="145" width="260" height="32" rx="6" fill="white" stroke="#27AE60" stroke-width="1.5"/>
          <text x="545" y="166" text-anchor="middle" fill="#1E8449" font-size="12" font-family="Source Sans 3, sans-serif">2. Fit scaler on TRAIN only</text>

          <text x="545" y="190" text-anchor="middle" fill="#27AE60" font-size="14">↓</text>

          <rect x="415" y="198" width="260" height="32" rx="6" fill="white" stroke="#27AE60" stroke-width="1.5"/>
          <text x="545" y="219" text-anchor="middle" fill="#1E8449" font-size="12" font-family="Source Sans 3, sans-serif">3. Transform train &amp; test</text>

          <text x="545" y="255" text-anchor="middle" fill="#1E8449" font-size="11" font-family="Source Sans 3, sans-serif">Test set is truly unseen.</text>
          <text x="545" y="272" text-anchor="middle" fill="#1E8449" font-size="11" font-family="Source Sans 3, sans-serif">Metrics reflect real-world performance.</text>
        </svg>
      </div>

      <p>This applies to <strong>all</strong> preprocessing steps, including scaling, imputation, encoding, and resampling. A scikit-learn <code>Pipeline</code> handles this automatically.</p>

      <div class="warning">
        <strong>Feature leakage:</strong> Some features encode the outcome. In Bank Marketing, <code>duration</code> records how long the call lasted, but you only know that <em>after</em> the call when you already know the result. Ask yourself: "Would I know this value <em>before</em> I need the prediction?" If not, remove it.
      </div>
    </div>
  </div>


  <!-- ==================== 8. PIPELINES ==================== -->
  <div class="concept" id="s8">
    <div class="concept-header">
      <div class="concept-num">8</div>
      <h2>Pipelines &amp; ColumnTransformer</h2>
    </div>
    <div class="concept-body">
      <p>A <span class="key-term">Pipeline</span> chains preprocessing and modelling steps into a single object. A <span class="key-term">ColumnTransformer</span> routes different features through different preprocessing branches. Together, they prevent data leakage and keep your code clean.</p>

      <div class="visual-panel">
        <svg viewBox="0 0 760 480" xmlns="http://www.w3.org/2000/svg" style="max-width:720px;">
          <text x="380" y="24" text-anchor="middle" fill="#682773" font-weight="700" font-size="15" font-family="Source Sans 3, sans-serif">ColumnTransformer + Pipeline</text>

          <!-- Pipeline dashed border -->
          <line x1="48" y1="38" x2="48" y2="470" stroke="#682773" stroke-width="2" stroke-dasharray="5,4"/>
          <text x="38" y="260" fill="#682773" font-weight="700" font-size="13" font-family="Source Sans 3, sans-serif" transform="rotate(-90,38,260)">Pipeline</text>

          <!-- Input box -->
          <rect x="290" y="44" width="180" height="36" rx="8" fill="#682773"/>
          <text x="380" y="67" text-anchor="middle" fill="white" font-weight="600" font-size="13" font-family="Source Sans 3, sans-serif">Raw feature matrix</text>

          <!-- Fan-out lines from bottom of input box to branch labels -->
          <line x1="310" y1="80" x2="145" y2="115" stroke="#2980B9" stroke-width="2"/>
          <line x1="380" y1="80" x2="380" y2="115" stroke="#E67E22" stroke-width="2"/>
          <line x1="450" y1="80" x2="615" y2="115" stroke="#27AE60" stroke-width="2"/>

          <!-- Branch labels (above boxes, with clear space) -->
          <text x="145" y="130" text-anchor="middle" fill="#2980B9" font-weight="700" font-size="12" font-family="Source Sans 3, sans-serif">Numerical</text>
          <text x="380" y="130" text-anchor="middle" fill="#E67E22" font-weight="700" font-size="12" font-family="Source Sans 3, sans-serif">Ordinal</text>
          <text x="615" y="130" text-anchor="middle" fill="#27AE60" font-weight="700" font-size="12" font-family="Source Sans 3, sans-serif">Nominal</text>

          <!-- NUMERICAL BRANCH -->
          <rect x="60" y="142" width="170" height="38" rx="6" fill="#EBF5FB" stroke="#2980B9" stroke-width="1.5"/>
          <text x="145" y="166" text-anchor="middle" fill="#1A5276" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">SimpleImputer(median)</text>

          <line x1="145" y1="180" x2="145" y2="200" stroke="#2980B9" stroke-width="1.5"/>

          <rect x="60" y="200" width="170" height="38" rx="6" fill="#EBF5FB" stroke="#2980B9" stroke-width="1.5"/>
          <text x="145" y="224" text-anchor="middle" fill="#1A5276" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">StandardScaler</text>

          <!-- ORDINAL BRANCH -->
          <rect x="295" y="142" width="170" height="38" rx="6" fill="#FEF5EC" stroke="#E67E22" stroke-width="1.5"/>
          <text x="380" y="166" text-anchor="middle" fill="#B7600A" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">OrdinalEncoder</text>

          <!-- NOMINAL BRANCH -->
          <rect x="530" y="142" width="170" height="38" rx="6" fill="#EAFAF1" stroke="#27AE60" stroke-width="1.5"/>
          <text x="615" y="166" text-anchor="middle" fill="#1E8449" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">SimpleImputer(mode)</text>

          <line x1="615" y1="180" x2="615" y2="200" stroke="#27AE60" stroke-width="1.5"/>

          <rect x="530" y="200" width="170" height="38" rx="6" fill="#EAFAF1" stroke="#27AE60" stroke-width="1.5"/>
          <text x="615" y="224" text-anchor="middle" fill="#1E8449" font-weight="600" font-size="12" font-family="Source Sans 3, sans-serif">OneHotEncoder</text>

          <!-- Merge lines -->
          <line x1="145" y1="238" x2="320" y2="290" stroke="#BDC3C7" stroke-width="2"/>
          <line x1="380" y1="180" x2="380" y2="290" stroke="#BDC3C7" stroke-width="2"/>
          <line x1="615" y1="238" x2="440" y2="290" stroke="#BDC3C7" stroke-width="2"/>

          <!-- ColumnTransformer merge label -->
          <text x="380" y="280" text-anchor="middle" fill="#5D6D7E" font-size="11" font-family="Source Sans 3, sans-serif">← ColumnTransformer recombines →</text>

          <!-- Preprocessed matrix -->
          <rect x="270" y="296" width="220" height="38" rx="8" fill="#9B59B6" opacity="0.85"/>
          <text x="380" y="320" text-anchor="middle" fill="white" font-weight="600" font-size="13" font-family="Source Sans 3, sans-serif">Preprocessed features</text>

          <!-- Arrow to SMOTE -->
          <line x1="380" y1="334" x2="380" y2="362" stroke="#BDC3C7" stroke-width="2"/>

          <!-- SMOTE (dashed, optional) -->
          <rect x="282" y="364" width="196" height="34" rx="6" fill="#F7ECF8" stroke="#9B59B6" stroke-width="1.5" stroke-dasharray="5,3"/>
          <text x="380" y="386" text-anchor="middle" fill="#4A1A52" font-size="12" font-family="Source Sans 3, sans-serif">SMOTE (optional, train only)</text>

          <!-- Arrow to classifier -->
          <line x1="380" y1="398" x2="380" y2="424" stroke="#BDC3C7" stroke-width="2"/>

          <!-- Classifier -->
          <rect x="290" y="426" width="180" height="38" rx="8" fill="#682773"/>
          <text x="380" y="450" text-anchor="middle" fill="white" font-weight="600" font-size="13" font-family="Source Sans 3, sans-serif">Classifier</text>
        </svg>
      </div>

      <div class="example">
        <strong>Why this matters:</strong> When you call <code>pipeline.fit(X_train, y_train)</code>, every transformer is automatically fit on training data only. When you call <code>pipeline.predict(X_test)</code>, the test data passes through the same transformations, but SMOTE is skipped. No leakage and no manual bookkeeping.
      </div>
    </div>
  </div>


  <!-- ==================== 9. QUICK REFERENCE TABLE ==================== -->
  <div class="concept" id="s9">
    <div class="concept-header">
      <div class="concept-num">9</div>
      <h2>Quick Reference Table</h2>
    </div>
    <div class="concept-body">
      <p>A summary of when to use each technique:</p>

      <table>
        <thead>
          <tr>
            <th>Technique</th>
            <th>What it does</th>
            <th>Use when</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Mean / median imputation</strong></td>
            <td>Fills missing numerical values with the average or middle value</td>
            <td>Small % missing, MCAR. Use median if skewed.</td>
          </tr>
          <tr>
            <td><strong>Mode imputation</strong></td>
            <td>Fills missing categorical values with the most frequent category</td>
            <td>Small % missing in categorical features</td>
          </tr>
          <tr>
            <td><strong>KNN imputation</strong></td>
            <td>Estimates missing values from similar rows</td>
            <td>MAR, where other features can predict the gap</td>
          </tr>
          <tr>
            <td><strong>One-hot encoding</strong></td>
            <td>Creates binary columns per category</td>
            <td>Nominal features (no order). Required for linear models.</td>
          </tr>
          <tr>
            <td><strong>Ordinal encoding</strong></td>
            <td>Maps categories to ordered integers</td>
            <td>Ordinal features (meaningful order exists)</td>
          </tr>
          <tr>
            <td><strong>StandardScaler</strong></td>
            <td>Centres to mean=0, std=1</td>
            <td>Default choice. Robust to outliers.</td>
          </tr>
          <tr>
            <td><strong>MinMaxScaler</strong></td>
            <td>Scales to [0, 1]</td>
            <td>Bounded output needed, no significant outliers.</td>
          </tr>
          <tr>
            <td><strong>SMOTE</strong></td>
            <td>Creates synthetic minority samples</td>
            <td>Imbalanced classes. Training set only.</td>
          </tr>
          <tr>
            <td><strong>class_weight='balanced'</strong></td>
            <td>Increases penalty for minority-class errors</td>
            <td>Imbalanced classes. Simpler alternative to SMOTE.</td>
          </tr>
          <tr>
            <td><strong>Pipeline</strong></td>
            <td>Chains preprocessing + model as one object</td>
            <td>Always. Prevents leakage and ensures reproducibility.</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>


  <!-- SUMMARY -->
  <div class="summary-card">
    <h3>✓ Key Takeaway</h3>
    <p>Every preprocessing step is a <strong>decision</strong>. This week aims to get you to develop <strong>justification</strong> for each choice, by connecting it to what you found during exploration. This helper page gives you the vocabulary and visual intuition.</p>
  </div>

</div>

<footer>
  CMM548 Machine Learning · Sophie Haynes · Robert Gordon University · Semester 2, 2026
</footer>

</body>
</html>
